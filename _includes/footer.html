<!-- Footer -->
<footer>
	<div class="container">
		<div class="row">
			<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
				<ul class="list-inline text-center">
					{% if site.RSS %}
					<li>
						<a href="{{ "/feed.xml" | prepend: site.baseurl }}">
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa fa-rss fa-stack-1x fa-inverse"></i>
							</span>
						</a>
					</li>
					{% endif %}
					<!-- add jianshu add target = "_blank" to <a> by BY -->
					{% if site.jianshu_username %}
					<li>
						<a target="_blank" href="https://www.jianshu.com/u/{{ site.jianshu_username }}">
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa  fa-stack-1x fa-inverse">简</i>
							</span>
						</a>
					</li>
					{% endif %}
					{% if site.twitter_username %}
					<li>
						<a href="https://twitter.com/{{ site.twitter_username }}">
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
							</span>
						</a>
					</li>
					{% endif %}

					<!-- add Weibo, Zhihu by Hux, add target = "_blank" to <a> by Hux -->
					{% if site.zhihu_username %}
					<li>
						<a target="_blank" href="https://www.zhihu.com/people/{{ site.zhihu_username }}">
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa  fa-stack-1x fa-inverse">知</i>
							</span>
						</a>
					</li>
					{% endif %}
					{% if site.weibo_username %}
					<li>
						<a target="_blank" href="http://weibo.com/{{ site.weibo_username }}">
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
							</span>
						</a>
					</li>
					{% endif %}


					{% if site.facebook_username %}
					<li>
						<a target="_blank" href="https://www.facebook.com/{{ site.facebook_username }}">
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
							</span>
						</a>
					</li>
					{% endif %}
					{% if site.github_username %}
					<li>
						<a target="_blank" href="https://github.com/{{ site.github_username }}">
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa fa-github fa-stack-1x fa-inverse"></i>
							</span>
						</a>
					</li>
					{% endif %}
					{% if site.linkedin_username %}
					<li>
						<a target="_blank" href="https://www.linkedin.com/in/{{ site.linkedin_username }}">
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
							</span>
						</a>
					</li>
					{% endif %}
					{% if site.email %}
					<li>
						<a href="mailto: {{ site.email }}">
							<span class=" fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
							</span>
						</a>
					</li>
					{% endif %}
				</ul>
				<p class="copyright text-muted">
					Copyright &copy; {{ site.title }} {{ site.time | date: '%Y' }}
					<br>
					Theme on <a href="{{ site.github_repo }}">GitHub</a> |
					<iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="100px"
						height="20px"
						src="https://ghbtns.com/github-btn.html?user={{ site.github_username }}&repo={{ site.github_username }}.github.io&type=star&count=true">
					</iframe>
				</p>
			</div>
		</div>
	</div>
</footer>

<!-- jQuery -->
<script src="{{ "/js/jquery.min.js " | prepend: site.baseurl }}"></script>

<!-- Bootstrap Core JavaScript -->
<script src="{{ "/js/bootstrap.min.js " | prepend: site.baseurl }}"></script>

<!-- Custom Theme JavaScript -->
<script src="{{ "/js/hux-blog.min.js " | prepend: site.baseurl }}"></script>

<!-- Service Worker -->
{% if site.service-worker %}
<script type="text/javascript">
	if (navigator.serviceWorker) {
		// For security reasons, a service worker can only control the pages that are in the same directory level or below it. That's why we put sw.js at ROOT level.
		navigator.serviceWorker
			.register('/sw.js')
			.then((registration) => { console.log('Service Worker Registered. ', registration) })
			.catch((error) => { console.log('ServiceWorker registration failed: ', error) })
	}
</script>
{% endif %}


<!-- async load function -->
<script>
	function async(u, c) {
		var d = document, t = 'script',
			o = d.createElement(t),
			s = d.getElementsByTagName(t)[0];
		o.src = u;
		if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
		s.parentNode.insertBefore(o, s);
	}
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/ 
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers   
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
	// only load tagcloud.js in tag.html
	if ($('#tag_cloud').length !== 0) {
		async('{{ "/js/jquery.tagcloud.js" | prepend: site.baseurl }}', function () {
			$.fn.tagcloud.defaults = {
				//size: {start: 1, end: 1, unit: 'em'},
				color: { start: '#bbbbee', end: '#0085a1' },
			};
			$('#tag_cloud a').tagcloud();
		})
	}
</script>

<!--fastClick.js -->
<script>
	async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
		var $nav = document.querySelector("nav");
		if ($nav) FastClick.attach($nav);
	})
</script>


<!-- Google Analytics -->
{% if site.ga_track_id %}
<script>
	// dynamic User by Hux
	var _gaId = '{{ site.ga_track_id }}';
	var _gaDomain = '{{ site.ga_domain }}';

	// Originial
	(function (i, s, o, g, r, a, m) {
		i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
			(i[r].q = i[r].q || []).push(arguments)
		}, i[r].l = 1 * new Date(); a = s.createElement(o),
			m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
	})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

	ga('create', _gaId, _gaDomain);
	ga('send', 'pageview');
</script>
{% endif %}


<!-- Baidu Tongji -->
{% if site.ba_track_id %}
<script>
	// dynamic User by Hux
	var _baId = '{{ site.ba_track_id }}';

	// Originial
	var _hmt = _hmt || [];
	(function () {
		var hm = document.createElement("script");
		hm.src = "//hm.baidu.com/hm.js?" + _baId;
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(hm, s);
	})();
</script>
{% endif %}



<!-- Side Catalog -->
{% if page.catalog %}
<script type="text/javascript">
	function generateCatalog(selector) {
		var P = $('div.post-container'), a, n, t, l, i, c;
		a = P.find('h1,h2,h3,h4,h5,h6');
		a.each(function () {
			n = $(this).prop('tagName').toLowerCase();
			i = "#" + $(this).prop('id');
			t = $(this).text();
			c = $('<a href="' + i + '" rel="nofollow" title="' + t + '">' + t + '</a>');
			l = $('<li class="' + n + '_nav"></li>').append(c);
			$(selector).append(l);
		});
		return true;
	}

	generateCatalog(".catalog-body");

	// toggle side catalog
	$(".catalog-toggle").click((function (e) {
		e.preventDefault();
		$('.side-catalog').toggleClass("fold")
	}))

	/*
	 * Doc: https://github.com/davist11/jQuery-One-Page-Nav
	 * Fork by Hux to support padding
	 */
	async("{{ '/js/jquery.nav.js' | prepend: site.baseurl }}", function () {
		$('.catalog-body').onePageNav({
			currentClass: "active",
			changeHash: !1,
			easing: "swing",
			filter: "",
			scrollSpeed: 700,
			scrollOffset: 0,
			scrollThreshold: .2,
			begin: null,
			end: null,
			scrollChange: null,
			padding: 80
		});
	});

</script>
{% endif %}

<script>
	// strip empty lines in post-preview link.title
	$(".post-preview-block").each((index, el) => {
		var title = el.getAttribute("title")
		var result = ''
		title = title.split('\n')
		var count = 0;
		for (let i = 0; i < title.length; ++i) {
			if (title[i].length) {
				result += title[i] + '\n'
				count++;
				if (count >= 5) break; // show at most 5 lines
			}
		}
		if (!result.endsWith('...')) result += '...'
		el.setAttribute("title", result)
	})
</script>

<script>
	//==========================================
	// File:    background.js
	// Title:   星空连线(鼠标跟随)
	// Auther:  XieNaoban
	// Version: v1.1
	// Note:    直接扔在<body>里
	//==========================================

	// Last Modified By: DiscreteTom(discrete_tom@outlook.com) on 2019-08-04

	// 可调参数
	var BACKGROUND_COLOR = "rgba(255,255,255,1)";   // 背景色
	// var BACKGROUND_COLOR = "rgba(0,43,54,1)";   // 背景色
	var POINT_NUM = 99;                         // 屏幕上点的数目
	var POINT_COLOR = "rgba(204,204,204,0.7)";  // 点的颜色
	var LINE_COLOR = "204, 204, 204";           // RGB
	var LINE_LENGTH = 10000;                    // 点之间连线长度(的平方)

	// 创建背景画布
	var cvs = document.createElement("canvas");
	cvs.width = window.innerWidth;
	cvs.height = window.innerHeight;
	cvs.style.cssText = "\
    position:fixed;\
    top:0px;\
    left:0px;\
    z-index:-1;\
    opacity:1.0;\
    ";
	document.body.appendChild(cvs);

	var ctx = cvs.getContext("2d");

	//随机数函数
	function randomInt(min, max) {
		return Math.floor((max - min + 1) * Math.random() + min);
	}

	function randomFloat(min, max) {
		return (max - min) * Math.random() + min;
	}

	//构造点类
	function Point() {
		this.x = randomFloat(0, cvs.width);
		this.y = randomFloat(0, cvs.height);

		var speed = randomFloat(0.3, 1.4);
		var angle = randomFloat(0, 2 * Math.PI);

		this.dx = Math.sin(angle) * speed;
		this.dy = Math.cos(angle) * speed;

		this.r = 1.2;

		this.color = POINT_COLOR;
	}

	Point.prototype.move = function () {
		var dx = this.x - p0.x;
		var dy = this.y - p0.y;
		var old_dis2 = dx * dx + dy * dy;
		this.x += this.dx;
		if (this.x < 0) {
			this.x = 0;
			this.dx = -this.dx;
		} else if (this.x > cvs.width) {
			this.x = cvs.width;
			this.dx = -this.dx;
		}
		this.y += this.dy;
		if (this.y < 0) {
			this.y = 0;
			this.dy = -this.dy;
		} else if (this.y > cvs.height) {
			this.y = cvs.height;
			this.dy = -this.dy;
		}

		// judge relation with mouse
		if (old_dis2 > LINE_LENGTH) return; // this point is not captured by mouse
		if (p0.x == null) return; // mouse is out of window
		dx = this.x - p0.x;
		dy = this.y - p0.y;
		var new_dis2 = dx * dx + dy * dy;
		if (new_dis2 > LINE_LENGTH) {
			// this point was captured by mouse but it's trying to escape
			let t = this.dx;
			this.dx = -this.dy;
			this.dy = t;
		}
	}

	Point.prototype.draw = function () {
		ctx.fillStyle = this.color;
		ctx.beginPath();
		ctx.arc(this.x, this.y, this.r, 0, Math.PI * 2);
		ctx.closePath();
		ctx.fill();
	}

	var points = [];

	function initPoints(num) {
		for (var i = 0; i < num; ++i) {
			points.push(new Point());
		}
	}

	var p0 = new Point(); //鼠标
	p0.dx = p0.dy = 0;
	document.onmousemove = function (ev) {
		p0.x = ev.clientX;
		p0.y = ev.clientY;
	}
	document.onmousedown = function (ev) {
		p0.x = ev.clientX;
		p0.y = ev.clientY;
	}
	document.onmouseup = function (ev) {
		p0.x = ev.clientX;
		p0.y = ev.clientY;
	}
	window.onmouseout = function () {
		p0.x = null;
		p0.y = null;
	}

	function drawLine(p1, p2, deg) {
		var dx = p1.x - p2.x;
		var dy = p1.y - p2.y;
		var dis2 = dx * dx + dy * dy;
		if (dis2 < 2 * LINE_LENGTH) {
			if (p1 === p0) {
				if (dis2 > LINE_LENGTH) {
					p2.x += dx * 0.03;
					p2.y += dy * 0.03;
				} else return;
			}
			var t = (1.05 - dis2 / LINE_LENGTH) * 0.2 * deg;
			ctx.strokeStyle = 'rgba(' + LINE_COLOR + ',' + t + ')';
			ctx.beginPath();
			ctx.lineWidth = 1.5;
			ctx.moveTo(p1.x, p1.y);
			ctx.lineTo(p2.x, p2.y);
			ctx.closePath();
			ctx.stroke();
		}
		return;
	}

	//绘制每一帧
	function drawFrame() {
		cvs.width = window.innerWidth;
		cvs.height = window.innerHeight;
		ctx.fillStyle = BACKGROUND_COLOR;
		ctx.fillRect(0, 0, cvs.width, cvs.height);

		var arr = (p0.x == null ? points : [p0].concat(points));
		for (var i = 0; i < arr.length; ++i) {
			for (var j = i + 1; j < arr.length; ++j) {
				drawLine(arr[i], arr[j], 1.0);
			}
			arr[i].draw();
			arr[i].move();
		}

		window.requestAnimationFrame(drawFrame);
	}

	initPoints(POINT_NUM);
	drawFrame();
</script>